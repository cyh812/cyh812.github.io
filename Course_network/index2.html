<!DOCTYPE html>
<html lang="en" style="height: 100%">

<head>
  <meta charset="utf-8">
</head>

<body style="height: 100%; margin: 0">
  <div id="container" style="height: 100%"></div>

  <select id="jsonFileSelect" style="position: absolute; top: 10px; left: 10px; padding: 5px; font-size: 14px;">
    <option value="data\材料科学与工程学院_不允许交叉.json">材料科学与工程学院_不允许交叉</option>
    <option value="data\材料科学与工程学院_允许交叉.json">材料科学与工程学院_允许交叉</option>
    <option value="data\传媒与国际文化学院_不允许交叉.json">传媒与国际文化学院_不允许交叉</option>
    <option value="data\传媒与国际文化学院_允许交叉.json">传媒与国际文化学院_允许交叉</option>
    <option value="data\地球科学学院_不允许交叉.json">地球科学学院_不允许交叉</option>
    <option value="data\地球科学学院_允许交叉.json">地球科学学院_允许交叉</option>
    <option value="data\电气工程学院_不允许交叉.json">电气工程学院_不允许交叉</option>
    <option value="data\电气工程学院_允许交叉.json">电气工程学院_允许交叉</option>
    <option value="data\动物科学学院_不允许交叉.json">动物科学学院_不允许交叉</option>
    <option value="data\动物科学学院_允许交叉.json">动物科学学院_允许交叉</option>
    <option value="data\高分子科学与工程学系_不允许交叉.json">高分子科学与工程学系_不允许交叉</option>
    <option value="data\高分子科学与工程学系_允许交叉.json">高分子科学与工程学系_允许交叉</option>
    <option value="data\工程师学院_不允许交叉.json">工程师学院_不允许交叉</option>
    <option value="data\工程师学院_允许交叉.json">工程师学院_允许交叉</option>
    <option value="data\公共管理学院_不允许交叉.json">公共管理学院_不允许交叉</option>
    <option value="data\公共管理学院_允许交叉.json">公共管理学院_允许交叉</option>
    <option value="data\管理学院_不允许交叉.json">管理学院_不允许交叉</option>
    <option value="data\管理学院_允许交叉.json">管理学院_允许交叉</option>
    <option value="data\光电科学与工程学院_不允许交叉.json">光电科学与工程学院_不允许交叉</option>
    <option value="data\光电科学与工程学院_允许交叉.json">光电科学与工程学院_允许交叉</option>
    <option value="data\光华法学院_不允许交叉.json">光华法学院_不允许交叉</option>
    <option value="data\光华法学院_允许交叉.json">光华法学院_允许交叉</option>
    <option value="data\国际教育学院_不允许交叉.json">国际教育学院_不允许交叉</option>
    <option value="data\国际教育学院_允许交叉.json">国际教育学院_允许交叉</option>
    <option value="data\国际联合学院（海宁国际校区）_不允许交叉.json">data\国际联合学院_海宁国际校区__不允许交叉.json</option>
    <option value="data\国际联合学院（海宁国际校区）_允许交叉.json">data\国际联合学院_海宁国际校区__允许交叉.json</option>
    <option value="data\海洋学院_不允许交叉.json">海洋学院_不允许交叉</option>
    <option value="data\海洋学院_允许交叉.json">海洋学院_允许交叉</option>
    <option value="data\航空航天学院_不允许交叉.json">航空航天学院_不允许交叉</option>
    <option value="data\航空航天学院_允许交叉.json">航空航天学院_允许交叉</option>
    <option value="data\化学工程与生物工程学院_不允许交叉.json">化学工程与生物工程学院_不允许交叉</option>
    <option value="data\化学工程与生物工程学院_允许交叉.json">化学工程与生物工程学院_允许交叉</option>
    <option value="data\化学系_不允许交叉.json">化学系_不允许交叉</option>
    <option value="data\化学系_允许交叉.json">化学系_允许交叉</option>
    <option value="data\环境与资源学院_不允许交叉.json">环境与资源学院_不允许交叉</option>
    <option value="data\环境与资源学院_允许交叉.json">环境与资源学院_允许交叉</option>
    <option value="data\机械工程学院_不允许交叉.json">机械工程学院_不允许交叉</option>
    <option value="data\机械工程学院_允许交叉.json">机械工程学院_允许交叉</option>
    <option value="data\计算机科学与技术学院_不允许交叉.json">计算机科学与技术学院_不允许交叉</option>
    <option value="data\计算机科学与技术学院_允许交叉.json">计算机科学与技术学院_允许交叉</option>
    <option value="data\建筑工程学院_不允许交叉.json">建筑工程学院_不允许交叉</option>
    <option value="data\建筑工程学院_允许交叉.json">建筑工程学院_允许交叉</option>
    <option value="data\教育学院_不允许交叉.json">教育学院_不允许交叉</option>
    <option value="data\教育学院_允许交叉.json">教育学院_允许交叉</option>
    <option value="data\经济学院_不允许交叉.json">经济学院_不允许交叉</option>
    <option value="data\经济学院_允许交叉.json">经济学院_允许交叉</option>
    <option value="data\控制科学与工程学院_不允许交叉.json">控制科学与工程学院_不允许交叉</option>
    <option value="data\控制科学与工程学院_允许交叉.json">控制科学与工程学院_允许交叉</option>
    <option value="data\马克思主义学院_不允许交叉.json">马克思主义学院_不允许交叉</option>
    <option value="data\马克思主义学院_允许交叉.json">马克思主义学院_允许交叉</option>
    <option value="data\能源工程学院_不允许交叉.json">能源工程学院_不允许交叉</option>
    <option value="data\能源工程学院_允许交叉.json">能源工程学院_允许交叉</option>
    <option value="data\农业与生物技术学院_不允许交叉.json">农业与生物技术学院_不允许交叉</option>
    <option value="data\农业与生物技术学院_允许交叉.json">农业与生物技术学院_允许交叉</option>
    <option value="data\人文学院_不允许交叉.json">人文学院_不允许交叉</option>
    <option value="data\人文学院_允许交叉.json">人文学院_允许交叉</option>
    <option value="data\软件学院_不允许交叉.json">软件学院_不允许交叉</option>
    <option value="data\软件学院_允许交叉.json">软件学院_允许交叉</option>
    <option value="data\生命科学学院_不允许交叉.json">生命科学学院_不允许交叉</option>
    <option value="data\生命科学学院_允许交叉.json">生命科学学院_允许交叉</option>
    <option value="data\生物系统工程与食品科学学院_不允许交叉.json">生物系统工程与食品科学学院_不允许交叉</option>
    <option value="data\生物系统工程与食品科学学院_允许交叉.json">生物系统工程与食品科学学院_允许交叉</option>
    <option value="data\生物医学工程与仪器科学学院_不允许交叉.json">生物医学工程与仪器科学学院_不允许交叉</option>
    <option value="data\生物医学工程与仪器科学学院_允许交叉.json">生物医学工程与仪器科学学院_允许交叉</option>
    <option value="data\数学科学学院_不允许交叉.json">数学科学学院_不允许交叉</option>
    <option value="data\数学科学学院_允许交叉.json">数学科学学院_允许交叉</option>
    <option value="data\外国语学院_不允许交叉.json">外国语学院_不允许交叉</option>
    <option value="data\外国语学院_允许交叉.json">外国语学院_允许交叉</option>
    <option value="data\物理学院_不允许交叉.json">物理学院_不允许交叉</option>
    <option value="data\物理学院_允许交叉.json">物理学院_允许交叉</option>
    <option value="data\心理与行为科学系_不允许交叉.json">心理与行为科学系_不允许交叉</option>
    <option value="data\心理与行为科学系_允许交叉.json">心理与行为科学系_允许交叉</option>
    <option value="data\信息与电子工程学院_不允许交叉.json">信息与电子工程学院_不允许交叉</option>
    <option value="data\信息与电子工程学院_允许交叉.json">信息与电子工程学院_允许交叉</option>
    <option value="data\药学院_不允许交叉.json">药学院_不允许交叉</option>
    <option value="data\药学院_允许交叉.json">药学院_允许交叉</option>
    <option value="data\医学院_不允许交叉.json">医学院_不允许交叉</option>
    <option value="data\医学院_允许交叉.json">医学院_允许交叉</option>
    <option value="data\艺术与考古学院_不允许交叉.json">艺术与考古学院_不允许交叉</option>
    <option value="data\艺术与考古学院_允许交叉.json">艺术与考古学院_允许交叉</option>
    <option value="data\浙江大学-西湖大学联培项目_不允许交叉.json">浙江大学-西湖大学联培项目_不允许交叉</option>
    <option value="data\浙江大学-西湖大学联培项目_允许交叉.json">浙江大学-西湖大学联培项目_允许交叉</option>
    <!-- 可以根据需要添加更多选项 -->
  </select>

  <script type="text/javascript" src="https://registry.npmmirror.com/jquery/3.7.1/files/dist/jquery.min.js"></script>
  <script type="text/javascript" src="https://registry.npmmirror.com/echarts/5.5.1/files/dist/echarts.min.js"></script>

  <script type="text/javascript">
    var dom = document.getElementById('container');
    var myChart = echarts.init(dom, null, {
      renderer: 'canvas',
      useDirtyRect: false
    });

    // 定义颜色映射
    var categoryColorMap = { 
      '人文学院': '#b9d76a', 
      '公共管理学院': '#ff82ff', 
      '工程师学院': '#00f0ff', 
      '农业与生物技术学院': '#ff7300', 
      '建筑工程学院': '#852437', 
      '经济学院': '#0075ca', 
      '光华法学院': '#ff65b5', 
      '管理学院': '#008887', 
      '医学院': '#0ae700', 
      '海洋学院': '#9b8300', 
      '外国语学院': '#a4b5bd', 
      '环境与资源学院': '#ffa75c', 
      '传媒与国际文化学院': '#434c00', 
      '地球科学学院': '#a45acb', 
      '教育学院': '#00de65', 
      '计算机科学与技术学院': '#ffaa00', 
      '动物科学学院': '#5d3d6d', 
      '电气工程学院': '#aed300', 
      '生物系统工程与食品科学学院': '#00e6c1', 
      '软件学院': '#ff9bd9', 
      '数学科学学院': '#004d36', 
      '机械工程学院': '#e7918b', 
      '航空航天学院': '#005572', 
      '生命科学学院': '#00dbff', 
      '能源工程学院': '#dc3831', 
      '信息与电子工程学院': '#007920', 
      '化学工程与生物工程学院': '#aba8ff', 
      '药学院': '#ff5a5b', 
      '控制科学与工程学院': '#31e2da', 
      '心理与行为科学系': '#7d3f00', 
      '生物医学工程与仪器科学学院': '#ff5eec', 
      '材料科学与工程学院': '#503f36', 
      '艺术与考古学院': '#00c4ff', 
      '马克思主义学院': '#73b084', 
      '物理学院': '#ba3c87', 
      '浙江大学-西湖大学联培项目': '#0096ca', 
      '化学系': '#85d3ff', 
      '光电科学与工程学院': '#4c9b00', 
      '高分子科学与工程系': '#af8f43', 
      '公共体育与艺术部': '#00def4', 
      '国际联合学院（海宁国际校区）': '#d76100', 
      '微纳电子学院': '#ffafff', 
      '国际教育学院': '#f9cc34', 
      '其他': '#f0cda2', 
      '研究生院': '#64e472', 
      '集成电路学院': '#fd0573' 
    };

    // 默认加载第一个 JSON 文件
    function loadChartData(filePath) {
      myChart.showLoading();

      $.get(filePath, function (webkitDep) {
        myChart.hideLoading();

        // 设置 option 配置
        var option = {
          title: {
            text: "浙\n江\n大\n学\n选\n课\n网\n络",
            left: "2%",
            top: "center",
            textStyle: {
              fontSize: 40
            },
          },
          legend: {
            type: 'scroll',
            orient: 'vertical',
            right: 10,
            top: 20,
            bottom: 20,
            data: webkitDep.categories.map(function (category) {
              category.itemStyle = {
                color: categoryColorMap[category.name] || '#000' // 根据 category 分配颜色
              };
              return category;
            }),
          },
          tooltip: {
            formatter: function (params) {
              if (params.dataType === 'node') {
                var node = params.data;
                var content = `
                  <b>节点信息:</b><br>
                  <b>ID:</b> ${node.id} <br>
                  <b>课程:</b> ${node["课程名称"]} <br>
                  <b>学院:</b> ${node["院系"]} <br>
                  <b>课程性质:</b> ${node['课程性质']} <br>
                  <b>课程体系:</b> ${node['课程体系']} <br>
                  <b>是否允许外院选课:</b> ${node['是否允许外院选课']} <br>
                  <b>上课语言:</b> ${node['上课语言']} <br>
                `;
                return content;
              } else if (params.dataType === 'edge') {
                var edge = params.data;
                var sourceNode = webkitDep.nodes.find(function (node) {
                  return node.id === edge.source;
                });
                var targetNode = webkitDep.nodes.find(function (node) {
                  return node.id === edge.target;
                });

                var sourceLabel = sourceNode ? sourceNode['课程名称'] : '未知课程';
                var targetLabel = targetNode ? targetNode['课程名称'] : '未知课程';

                return `
                  <b>连边信息:</b><br>
                  <b>源节点课程名:</b> ${sourceLabel} <br>
                  <b>目标节点课程名:</b> ${targetLabel} <br>
                `;
              }
            },
            backgroundColor: 'rgba(255, 255, 255, 0.8)',
            borderColor: '#ccc',
            borderWidth: 1,
            padding: 10
          },
          series: [
            {
              type: 'graph',
              layout: 'force',
              animation: false,
              roam: true,
              draggable: true,
              data: webkitDep.nodes.map(function (node) {
                var category = node.category;
                var color = categoryColorMap[category] || '#000';
                node.itemStyle = {
                  color: color
                };
                return node;
              }),
              categories: webkitDep.categories,
              force: {
                edgeLength: 5,
                repulsion: 20,
                gravity: 0.2
              },
              edges: webkitDep.links
            }
          ]
        };
        myChart.setOption(option);
      });
    }

    // 初始加载默认 JSON 文件
    loadChartData('data/传媒与国际文化学院_不允许交叉.json');

    // 监听下拉框的 change 事件，切换文件
    $('#jsonFileSelect').on('change', function () {
      var selectedFile = this.value;
      myChart.clear(); // 清空现有图表
      loadChartData(selectedFile); // 加载选中的 JSON 文件并更新图表
    });

    // 监听窗口大小变化，调整图表大小
    window.addEventListener('resize', myChart.resize);
  </script>
</body>

</html>
